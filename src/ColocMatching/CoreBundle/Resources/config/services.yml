imports:
    - { resource: "@CoreBundle/Resources/config/listeners.yml" }
    - { resource: "@CoreBundle/Resources/config/managers.yml" }

services:
    # ----------  Security  ----------
    coloc_matching.core.user_provider:
        class: ColocMatching\CoreBundle\Security\User\UserProvider
        arguments: ["@coloc_matching.core.user_manager"]


    coloc_matching.core.jwt_user_extractor:
        class: ColocMatching\CoreBundle\Security\User\JwtUserExtractor
        arguments:
            - "@lexik_jwt_authentication.extractor.authorization_header_extractor"
            - "@lexik_jwt_authentication.encoder"
            - "@coloc_matching.core.user_manager"

        
    # ----------- Validator -----------
    coloc_matching.core.entity_validator:
        class: ColocMatching\CoreBundle\Validator\EntityValidator
        arguments: ["@logger", "@form.factory"]


    # ----------- FormTypes ----------
    coloc_matching.form.type.boolean:
        class: ColocMatching\CoreBundle\Form\Type\BooleanType
        tags:
            - { name: "form.type", alias: "boolean" }
            
    coloc_matching.form.type.address:
        class: ColocMatching\CoreBundle\Form\Type\AddressType
        tags:
            - { name: "form.type", alias: "address" }
            

    # ----------- Others -----------
    coloc_matching.core.filter_factory:
        class: ColocMatching\CoreBundle\Repository\Filter\FilterFactory
        arguments: ["@form.factory"]


    coloc_matching.core.event_dispatcher_visitor:
        class: ColocMatching\CoreBundle\Service\EventDispatcherVisitor
        arguments:
            - "@event_dispatcher"
            - "@coloc_matching.core.jwt_user_extractor"
            - "@logger"
